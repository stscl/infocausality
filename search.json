[{"path":"https://stscl.github.io/infocausality/articles/surd.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Synergistic-Unique-Redundant Decomposition of Causality (SURD)","text":"Understanding causal influences combine interact essential temporal spatial systems. Synergistic–Unique–Redundant Decomposition (SURD) framework provides principled way break total information flow variables : Unique contributions — information uniquely provided one driver; Redundant contributions — information shared multiple drivers; Synergistic contributions — information revealed drivers considered together. vignette demonstrates perform SURD analysis using infocausality package. explore temporal spatial cases, showing infocausality unifies time-series spatial cross-sectional causal analysis via consistent interfaces data.frame, sf, SpatRaster objects.","code":""},{"path":"https://stscl.github.io/infocausality/articles/surd.html","id":"utility-functions","dir":"Articles","previous_headings":"","what":"Utility Functions","title":"Synergistic-Unique-Redundant Decomposition of Causality (SURD)","text":"simplify post-processing visualization, two helper functions provided . utils_process_surd_result() converts surd_list object (returned SURD computation routine) tidy tibble plotting analysis. utils_plot_surd() produces SURD decomposition plot — grouped bar chart unique (U), synergistic (S), redundant (R) components, along side panel showing information leak.","code":"utils_process_surd_result = \\(surd_list,threshold = 0){   I_unique = surd_list$unique   I_synergistic = surd_list$synergistic   I_redundant = surd_list$redundant   info_leak = surd_list$info_leak    df = tibble::tibble(     label = c(       paste0(\"U[\", names(I_unique), \"]\"),       paste0(\"S[\", names(I_synergistic), \"]\"),       paste0(\"R[\", names(I_redundant), \"]\")     ),     value = c(as.numeric(I_unique),               as.numeric(I_synergistic),               as.numeric(I_redundant)),     type = c(rep(\"unique\", length(I_unique)),              rep(\"synergistic\", length(I_synergistic)),              rep(\"redundant\", length(I_redundant)))   )    df$value = df$value / sum(df$value)   if(threshold > 0){     df = dplyr::filter(df, value > threshold)   }   return(dplyr::bind_rows(df,tibble::tribble(~label,~value,~type,                                              \"Info Leak\", info_leak, \"info leak\"))) } utils_plot_surd = \\(surd_list,threshold = 0,style = \"shallow\"){   I_unique = surd_list$unique   I_synergistic = surd_list$synergistic   I_redundant = surd_list$redundant    df = tibble::tibble(     label = c(       paste0(\"U[\", names(I_unique), \"]\"),       paste0(\"S[\", names(I_synergistic), \"]\"),       paste0(\"R[\", names(I_redundant), \"]\")     ),     value = c(as.numeric(I_unique),               as.numeric(I_synergistic),               as.numeric(I_redundant)),     type = c(rep(\"unique\", length(I_unique)),              rep(\"synergistic\", length(I_synergistic)),              rep(\"redundant\", length(I_redundant)))   )    df$value = df$value / sum(df$value)   if(threshold > 0){     df = dplyr::filter(df, value > threshold)   }   df$label = factor(df$label, levels = df$label)    if (style == \"shallow\") {     colors = c(unique = \"#ec9e9e\", synergistic = \"#fac58c\", redundant = \"#668392\", infoleak = \"#7f7f7f\")   } else {     colors = c(unique = \"#d62828\", synergistic = \"#f77f00\", redundant = \"#003049\", infoleak = \"gray\")   }    p1 = ggplot2::ggplot(df, ggplot2::aes(x = label, y = value, fill = type)) +     ggplot2::geom_col(color = \"black\", linewidth = 0.15, show.legend = FALSE) +     ggplot2::scale_fill_manual(name = NULL, values = colors) +     ggplot2::scale_x_discrete(name = NULL, labels = function(x) parse(text = x)) +     ggplot2::scale_y_continuous(name = NULL, limits = c(0, 1), expand = c(0, 0),                                 breaks = c(0, 0.25, 0.5, 0.75, 1),                                 labels = c(\"0\", \"0.25\", \"0.5\", \"0.75\", \"1\") ) +     ggplot2::theme_bw() +     ggplot2::theme(       axis.ticks.x = ggplot2::element_blank(),       axis.text.x = ggplot2::element_text(angle = 45, hjust = 1),       panel.grid = ggplot2::element_blank(),       panel.border = ggplot2::element_rect(color = \"black\", linewidth = 2)     )    df_leak = tibble::tibble(label = \"Info Leak\", value = surd_list$info_leak)   p2 = ggplot2::ggplot(df_leak, ggplot2::aes(x = label, y = value)) +     ggplot2::geom_col(fill = colors[4], color = \"black\", linewidth = 0.15) +     ggplot2::scale_x_discrete(name = NULL, expand = c(0, 0)) +     ggplot2::scale_y_continuous(name = NULL, limits = c(0, 1), expand = c(0, 0),                                 breaks = c(0,1), labels = c(0,1) ) +     ggplot2::theme_bw() +     ggplot2::theme(       axis.ticks.x = ggplot2::element_blank(),       panel.grid = ggplot2::element_blank(),       panel.border = ggplot2::element_rect(color = \"black\", linewidth = 2)     )    patchwork::wrap_plots(p1, p2, ncol = 2, widths = c(10,1)) }"},{"path":"https://stscl.github.io/infocausality/articles/surd.html","id":"example-cases","dir":"Articles","previous_headings":"","what":"Example Cases","title":"Synergistic-Unique-Redundant Decomposition of Causality (SURD)","text":"following sections demonstrate SURD decomposition different contexts, illustrating flexibility across temporal spatial causal analyses.","code":""},{"path":"https://stscl.github.io/infocausality/articles/surd.html","id":"air-pollution-and-cardiovascular-health-in-hong-kong","dir":"Articles","previous_headings":"Example Cases","what":"Air Pollution and Cardiovascular Health in Hong Kong","title":"Synergistic-Unique-Redundant Decomposition of Causality (SURD)","text":"investigate causal influences air pollutants incidence cardiovascular diseases, performed SURD analysis using time lag step 3 10 discretization bins. SURD results shown figure :","code":"cvd = readr::read_csv(system.file(\"case/cvd.csv\",package = \"tEDM\")) head(cvd) ## # A tibble: 6 × 5 ##     cvd   rsp   no2   so2    o3 ##   <dbl> <dbl> <dbl> <dbl> <dbl> ## 1   214  73.7  74.5  19.1 17.4  ## 2   203  77.6  80.9  18.8 39.4  ## 3   202  64.8  67.1  13.8 56.4  ## 4   182  68.8  74.7  30.8  5.6  ## 5   181  49.4  62.3  23.1  3.6  ## 6   129  67.4  63.6  17.4  6.73 cvd_long = cvd |>   tibble::rowid_to_column(\"id\") |>   tidyr::pivot_longer(cols = -id,                       names_to = \"variable\", values_to = \"value\")  fig_cvds_ts = ggplot2::ggplot(cvd_long, ggplot2::aes(x = id, y = value, color = variable)) +   ggplot2::geom_line(linewidth = 0.5) +   ggplot2::labs(x = \"Days (from 1995-3 to 1997-11)\", y = \"Concentrations or \\nNO. of CVD admissions\", color = \"\") +   ggplot2::theme_bw() +   ggplot2::theme(legend.direction = \"horizontal\",                  legend.position = \"inside\",                  legend.justification = c(\"center\",\"top\"),                  legend.background = ggplot2::element_rect(fill = \"transparent\", color = NA)) fig_cvds_ts res_cvds = infocausality::surd(cvd, \"cvd\",                                c(\"rsp\", \"no2\", \"so2\", \"o3\"),                                lag = 3, bin = 10, cores = 6) ##  ## SURD Decomposition Results: ##   Unique (U): ##     X1             : 0.0018 ##     X2             : 0.0167 ##     X3             : 0.0005 ##     X4             : 0.0005 ##   Synergistic (S): ##     X1-X2          : 0.0232 ##     X1-X3          : 0.0167 ##     X1-X4          : 0.0115 ##     X2-X3          : 0.0169 ##     X2-X4          : 0.0676 ##     X3-X4          : 0.0405 ##     X1-X2-X3       : 0.1263 ##     X1-X2-X4       : 0.0319 ##     X1-X3-X4       : 0.0536 ##     X2-X3-X4       : 0.1394 ##     X1-X2-X3-X4    : 0.3974 ##   Redundant (R): ##     X1-X2          : 0.0101 ##     X1-X3          : 0.0020 ##     X1-X4          : 0.0000 ##     X2-X3          : 0.0000 ##     X2-X4          : 0.0029 ##     X3-X4          : 0.0000 ##     X1-X2-X3       : 0.0015 ##     X1-X2-X4       : 0.0088 ##     X1-X3-X4       : 0.0010 ##     X2-X3-X4       : 0.0001 ##     X1-X2-X3-X4    : 0.0291 ##   Information Leak:  56.67% utils_plot_surd(res_cvds)"},{"path":"https://stscl.github.io/infocausality/articles/surd.html","id":"population-density-and-its-drivers-in-mainland-china","dir":"Articles","previous_headings":"Example Cases","what":"Population Density and Its Drivers in Mainland China","title":"Synergistic-Unique-Redundant Decomposition of Causality (SURD)","text":"","code":"popd_nb = spdep::read.gal(system.file(\"case/popd_nb.gal\",package = \"spEDM\")) ## Warning in spdep::read.gal(system.file(\"case/popd_nb.gal\", package = \"spEDM\")): neighbour ## object has 4 sub-graphs popd = readr::read_csv(system.file(\"case/popd.csv\",package = \"spEDM\")) popd_sf = sf::st_as_sf(popd, coords = c(\"lon\",\"lat\"), crs = 4326) popd_sf ## Simple feature collection with 2806 features and 5 fields ## Geometry type: POINT ## Dimension:     XY ## Bounding box:  xmin: 74.9055 ymin: 18.2698 xmax: 134.269 ymax: 52.9346 ## Geodetic CRS:  WGS 84 ## # A tibble: 2,806 × 6 ##     popd  elev   tem   pre slope          geometry ##  * <dbl> <dbl> <dbl> <dbl> <dbl>       <POINT [°]> ##  1  780.     8  17.4 1528. 0.452 (116.912 30.4879) ##  2  395.    48  17.2 1487. 0.842 (116.755 30.5877) ##  3  261.    49  16.0 1456. 3.56  (116.541 30.7548) ##  4  258.    23  17.4 1555. 0.932  (116.241 30.104) ##  5  211.   101  16.3 1494. 3.34   (116.173 30.495) ##  6  386.    10  16.6 1382. 1.65  (116.935 30.9839) ##  7  350.    23  17.5 1569. 0.346 (116.677 30.2412) ##  8  470.    22  17.1 1493. 1.88  (117.066 30.6514) ##  9 1226.    11  17.4 1526. 0.208 (117.171 30.5558) ## 10  137.   598  13.9 1458. 5.92  (116.208 30.8983) ## # ℹ 2,796 more rows res_popd = infocausality::surd(popd_sf,\"popd\",c(\"elev\",\"tem\",\"pre\",\"slope\"),                                lag = 3, bin = 10, nb = popd_nb, cores = 6) ##  ## SURD Decomposition Results: ##   Unique (U): ##     X1             : 0.0046 ##     X2             : 0.0000 ##     X3             : 0.0398 ##     X4             : 0.0036 ##   Synergistic (S): ##     X1-X2          : 0.0369 ##     X1-X3          : 0.0471 ##     X1-X4          : 0.0885 ##     X2-X3          : 0.0468 ##     X2-X4          : 0.0765 ##     X3-X4          : 0.0877 ##     X1-X2-X3       : 0.0384 ##     X1-X2-X4       : 0.0597 ##     X1-X3-X4       : 0.0463 ##     X2-X3-X4       : 0.1577 ##     X1-X2-X3-X4    : 0.1095 ##   Redundant (R): ##     X1-X2          : 0.0000 ##     X1-X3          : 0.0089 ##     X1-X4          : 0.0000 ##     X2-X3          : 0.0130 ##     X2-X4          : 0.0027 ##     X3-X4          : 0.0138 ##     X1-X2-X3       : 0.0056 ##     X1-X2-X4       : 0.0000 ##     X1-X3-X4       : 0.0120 ##     X2-X3-X4       : 0.0110 ##     X1-X2-X3-X4    : 0.0897 ##   Information Leak:  64.64% utils_plot_surd(res_popd)"},{"path":"https://stscl.github.io/infocausality/articles/surd.html","id":"influence-of-climatic-and-topographic-factors-on-net-primary-productivity-npp-in-mainland-china","dir":"Articles","previous_headings":"Example Cases","what":"Influence of Climatic and Topographic Factors on Net Primary Productivity (NPP) in Mainland China","title":"Synergistic-Unique-Redundant Decomposition of Causality (SURD)","text":"🧩 See also: ?infocausality::surd() function details. spEDM package spatial empirical dynamic modeling. tEDM package temporal empirical dynamic modeling.","code":"npp = terra::rast(system.file(\"case/npp.tif\", package = \"spEDM\")) npp ## class       : SpatRaster  ## size        : 404, 483, 5  (nrow, ncol, nlyr) ## resolution  : 10000, 10000  (x, y) ## extent      : -2625763, 2204237, 1877078, 5917078  (xmin, xmax, ymin, ymax) ## coord. ref. : CGCS2000_Albers  ## source      : npp.tif  ## names       :      npp,        pre,      tem,      elev,         hfp  ## min values  :   164.00,   384.3409, -47.8194, -122.2004,  0.03390418  ## max values  : 16606.33, 23878.3555, 263.6938, 5350.4902, 44.90312195 res_npp = infocausality::surd(npp,\"npp\",c(\"pre\",\"tem\",\"elev\",\"hfp\"),                               lag = 3, bin = 10, cores = 6) ##  ## SURD Decomposition Results: ##   Unique (U): ##     X1             : 0.2028 ##     X2             : 0.0009 ##     X3             : 0.0000 ##     X4             : 0.0000 ##   Synergistic (S): ##     X1-X2          : 0.0502 ##     X1-X3          : 0.0781 ##     X1-X4          : 0.0305 ##     X2-X3          : 0.0321 ##     X2-X4          : 0.0031 ##     X3-X4          : 0.0009 ##     X1-X2-X3       : 0.0300 ##     X1-X2-X4       : 0.0080 ##     X1-X3-X4       : 0.0476 ##     X2-X3-X4       : 0.0200 ##     X1-X2-X3-X4    : 0.0756 ##   Redundant (R): ##     X1-X2          : 0.2704 ##     X1-X3          : 0.0015 ##     X1-X4          : 0.0000 ##     X2-X3          : 0.0000 ##     X2-X4          : 0.0000 ##     X3-X4          : 0.0000 ##     X1-X2-X3       : 0.0470 ##     X1-X2-X4       : 0.0000 ##     X1-X3-X4       : 0.0053 ##     X2-X3-X4       : 0.0000 ##     X1-X2-X3-X4    : 0.0960 ##   Information Leak:  41.30% utils_plot_surd(res_npp)"},{"path":"https://stscl.github.io/infocausality/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Wenbo Lv. Author, maintainer, copyright holder.","code":""},{"path":"https://stscl.github.io/infocausality/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lv W (2025). infocausality: Information-Theoretic Measure Causality. R package version 1.0, https://stscl.github.io/infocausality/.","code":"@Manual{,   title = {infocausality: Information-Theoretic Measure of Causality},   author = {Wenbo Lv},   year = {2025},   note = {R package version 1.0},   url = {https://stscl.github.io/infocausality/}, }"},{"path":"https://stscl.github.io/infocausality/index.html","id":"infocausality","dir":"","previous_headings":"","what":"infocausality | Information-Theoretic Measure of Causality\n","title":"infocausality | Information-Theoretic Measure of Causality\n","text":"Information-Theoretic Measure Causality infocausality R package information-theoretic causal analysis. quantifies temporal spatial causality information flow, decomposes unique, redundant, synergistic components. package provides native support data.frame, sf, SpatRaster objects, offering unified interface time-series spatial cross-sectional causal analysis. Refer package documentation https://stscl.github.io/infocausality/ detailed information.","code":""},{"path":"https://stscl.github.io/infocausality/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"infocausality | Information-Theoretic Measure of Causality\n","text":"Install CRAN : Install binary version R-universe : Install source code GitHub :","code":"install.packages(\"infocausality\", dep = TRUE) install.packages(\"infocausality\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE) if (!requireNamespace(\"devtools\")) {     install.packages(\"devtools\") } devtools::install_github(\"stscl/infocausality\",                          build_vignettes = TRUE,                          dep = TRUE)"},{"path":"https://stscl.github.io/infocausality/reference/surd.html","id":null,"dir":"Reference","previous_headings":"","what":"synergistic-unique-redundant decomposition of causality — surd","title":"synergistic-unique-redundant decomposition of causality — surd","text":"synergistic-unique-redundant decomposition causality","code":""},{"path":"https://stscl.github.io/infocausality/reference/surd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"synergistic-unique-redundant decomposition of causality — surd","text":"","code":"# S4 method for class 'data.frame' surd(   data,   target,   agents,   lag = 1,   bin = 5,   max.combs = NULL,   cores = 1,   backend = \"threading\" )  # S4 method for class 'sf' surd(   data,   target,   agents,   lag = 1,   bin = 5,   max.combs = NULL,   cores = 1,   backend = \"threading\",   nb = NULL )  # S4 method for class 'SpatRaster' surd(   data,   target,   agents,   lag = 1,   bin = 5,   max.combs = NULL,   cores = 1,   backend = \"threading\" )"},{"path":"https://stscl.github.io/infocausality/reference/surd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"synergistic-unique-redundant decomposition of causality — surd","text":"data observation data. target name target variable. agents names agent variables. lag (optional) lag order. bin (optional) number discretization bins. max.combs (optional) maximum combination order. NULL, standard SURD decomposition applied. cores (optional) number cores parallel computation. backend (optional) Joblib backend: loky, threading, multiprocessing. nb (optional) neighbours list.","code":""},{"path":"https://stscl.github.io/infocausality/reference/surd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"synergistic-unique-redundant decomposition of causality — surd","text":"list. unique Unique information contributions per variable. synergistic Synergistic information components agent combinations. redundant Redundant information shared agent subsets. mutual_info Mutual information measures combination. info_leak Information leak ratio.","code":""},{"path":"https://stscl.github.io/infocausality/reference/surd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"synergistic-unique-redundant decomposition of causality — surd","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ tryCatch({   surd(columbus,\"hoval\",c(\"inc\",\"crime\")) }, error = function(e) {   message(\"Skipping Python-dependent example: \", e$message) }) # }"},{"path":[]},{"path":"https://stscl.github.io/infocausality/news/index.html","id":"new-1-0","dir":"Changelog","previous_headings":"","what":"new","title":"infocausality 1.0","text":"Implement surd generic synergistic-unique-redundant decomposition causality (#13).","code":""}]
